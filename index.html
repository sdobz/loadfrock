<html ng-app="LoadFrock">
<head>
    <link rel="stylesheet" href="css/bootstrap.min.css">
    <link rel="stylesheet" href="css/app.css">
</head>
<body ng-controller="FrockBodyCtrl">
    <div class="wrapper container">
        <section class="title-section">
            <h1>LoadFrock</h1>
        </section>
        <div class="col-md-4 col-xs-12">
            <section ng-controller="SlaveCtrl" class="row slave-section">
                <h2 class="center-title">Slaves</h2>
                <div>
                    <div ng-hide="!slave_service.slaves" class="text-center no-slaves">
                        No Slaves Connected
                    </div>
                    <div ng-repeat="(id, slave) in slave_service.slaves">
                        <div ng-click="slave.detail_visible = !slave.detail_visible" class="slave-header">
                            {{ slave.hostname }}
                        </div>
                        <div collapse="!slave.detail_visible" class="slave-body row">
                            <h3>Memory</h3>
                            <div class="col-sm-3 col-xs-12">
                                Physical
                            </div>
                            <div class="col-sm-9 col-xs-12">
                                <div class="progress">
                                  <div class="progress-bar" role="progressbar" aria-valuenow="{{ slave.memory.physical[0] }}" aria-valuemin="0" aria-valuemax="{{ slave.memory.physical[1] }}" style="width: {{ slave.memory.physical[0]*100 / slave.memory.physical[1] }}%;">
                                    {{ slave.memory.physical[0] | bytes }}/{{ slave.memory.physical[1] | bytes }}
                                  </div>
                                </div>
                            </div>
                            <!--
                            <div class="col-sm-3 col-xs-12">
                                Virtual
                            </div>
                            <div class="col-sm-9 col-xs-12">
                                <div class="progress">
                                  <div class="progress-bar" role="progressbar" aria-valuenow="{{ slave.memory.virtual[0] }}" aria-valuemin="0" aria-valuemax="{{ slave.memory.virtual[1] }}" style="width: {{ slave.memory.virtual[0]*100 / slave.memory.virtual[1] }}%;">
                                    {{ slave.memory.virtual[0] | bytes }}/{{ slave.memory.virtual[1] | bytes }}
                                  </div>
                                </div>
                            </div>
                            -->
                            <div class="col-sm-3 col-xs-12">
                                Swap
                            </div>
                            <div class="col-sm-9 col-xs-12">
                                <div class="progress">
                                  <div class="progress-bar" role="progressbar" aria-valuenow="{{ slave.memory.swap[0] }}" aria-valuemin="0" aria-valuemax="{{ slave.memory.swap[1] }}" style="width: {{ slave.memory.swap[0]*100 / slave.memory.swap[1] }}%;">
                                    {{ slave.memory.swap[0] | bytes }}/{{ slave.memory.swap[1] | bytes }}
                                  </div>
                                </div>
                            </div>
                            <div class="col-xs-12 col-sm-3">
                                <h3>Load</h3>
                            </div>
                            <div class="col-xs-12 col-sm-9">
                                <div class="progress">
                                  <div class="progress-bar" role="progressbar" aria-valuenow="{{ slave.load }}" aria-valuemin="0" aria-valuemax="100" style="width: {{ slave.load }}%;">
                                    {{ slave.load }}%
                                  </div>
                                </div>
                            </div>
                            <h3>Bandwidth</h3>
                            <div class="col-xs-2">
                                In
                            </div>
                            <div class="col-xs-5">
                                {{ slave.bandwidth.in[0] | bytes }}/s
                            </div>
                            <div class="col-xs-5">
                                {{ slave.bandwidth.in[1] | bytes }}
                            </div>

                            <div class="col-xs-2">
                                Out
                            </div>
                            <div class="col-xs-5">
                                {{ slave.bandwidth.out[0] | bytes }}/s
                            </div>
                            <div class="col-xs-5">
                                {{ slave.bandwidth.out[1] | bytes }}
                            </div>
                            <button class="btn btn-danger" ng-click="slave_service.kill_slave(slave.id)">
                                Kill
                            </button>
                        </div>
                    </div>
                </div>
            </section>
        </div>
        <div class="col-md-8 col-xs-12" ng-controller="TestCtrl">
            <div class="row">
                <h2 class="center-title test-title col-xs-6">Test</h2>
                <ul class="glyphicon-buttons header-buttons col-xs-6 text-center">
                    <li class="glyphicon glyphicon-floppy-open" ng-click="open_load_modal()">Load</li>
                    <li class="glyphicon glyphicon-floppy-save" ng-click="test.save()">Save</li>
                </ul>
            </div>
            <alert type="success" class="row save-successful" ng-hide="!save_alert_visible" ng-click="save_alert_visible = false">
                Save Successful
            </alert>
            <div class="test-properties row">
                <div class="col-sm-6 col-xs-12">
                    <div class="form-group">
                        <label for="test-name">Test Name</label>
                        <input class="form-control" id="test-name" placeholder="Test Frock" ng-model="test.name" ng-change="send_test_prop('name')">
                    </div>
                    <div class="form-group">
                        <label for="test-base">Base URL</label>
                        <input class="form-control" id="test-base" placeholder="http://example.com" ng-model="test.base" ng-change="send_test_prop('base')">
                    </div>
                </div>
                <div class="col-sm-6 col-xs-12">
                    <div class="form-group">
                        <label for="test-runs">Test Repetitions</label>
                        <input class="form-control" id="test-runs" placeholder="1000" ng-model="test.runs" ng-change="send_test_prop('runs')">
                    </div>
                    <label>&nbsp</label>
                    <button class="btn btn-success wide-button">Run</button>
                </div>
            </div>
            <div class="clearfix"></div>
            <div class="row">
                <h2 class="center-title test-title col-xs-6">Action</h2>
                <ul class="glyphicon-buttons header-buttons col-xs-6 text-center">
                    <li class="glyphicon glyphicon-plus" ng-click="test.add_action(0)">Top</li>
                    <li class="glyphicon glyphicon-plus" ng-click="test.add_action(actions.length)">Bottom</li>
                </ul>
            </div>
            <div class="action-group" ng-repeat="action in test.actions">
                <div class="action-wrapper row">
                    <div class="action-header row"
                         ng-class="{'no-bottom-radius': action.body_visible}">
                        <div class="col-xs-1">
                            <span class="glyphicon action-expander"
                                  ng-class="{
                                    'glyphicon-plus-sign': !action.body_visible,
                                    'glyphicon-minus-sign': action.body_visible
                                  }"
                                  ng-click="action.body_visible=!action.body_visible"></span>
                        </div>
                        <div class="form-group col-sm-3">
                            <label for="test-name">Name {{$index}}</label>
                            <input class="form-control" placeholder="Api Action">
                        </div>
                        <div class="form-group col-sm-3">
                            <label for="test-base">URL</label>
                            <input class="form-control" placeholder="/api/url/">
                        </div>
                        <div class="form-group col-sm-2 col-xs-6">
                            <label for="test-base">Probability</label>
                            <input class="form-control" placeholder="75%">
                        </div>
                        <ul class="glyphicon-buttons col-sm-3 col-xs-6 text-center">
                            <li class="glyphicon glyphicon-plus" ng-click="test.add_action($index)">Above</li>
                            <li class="glyphicon glyphicon-plus" ng-click="test.add_action($index+1)">Below</li>
                        </ul>
                    </div>
                    <div class="action-body row" ng-hide="!action.body_visible">
                        <div class="form-group col-sm-6">
                            <label for="test-base">Python Conditional</label>
                            <input class="form-control" placeholder="previous_output['value'] == 'something'">
                        </div>
                        <div class="form-group col-sm-6">
                            <label for="test-base">Store Output</label>
                            <input class="form-control" placeholder="variable_name">
                        </div>
                        <div class="form-group col-xs-12">
                            <label for="test-base">Input</label>
                            <textarea class="form-control" placeholder='{"json":"input"}'></textarea>
                        </div>
                    </div>
                </div>
                <div class="clearfix"></div>
            </div>
        </div>
    </div>
    <script type="text/ng-template" id="load_modal.html">
        <div class="modal-header">
            <h3>Load Test</h3>
        </div>
        <div class="modal-body">
            <button ng-repeat="test_name in test_loader.available_tests"
                    class="btn btn-info wide-button load-button"
                    ng-click="load(test_name)">
                Load "{{ test_name }}"
            </button>
        </div>
        <div class="modal-footer">
            <button class="btn btn-warning" ng-click="cancel()">Cancel</button>
        </div>
    </script>

    <script type="text/javascript" src="js/angular.js"></script>
    <script type="text/javascript" src="js/ui-bootstrap-tpls-0.10.0.min.js"></script>
    <script type="text/javascript" src="js/app.js"></script>
</body>
</html>
